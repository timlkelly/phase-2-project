<h1>Air Quality Conditions for "<%= @saved_location.name %>"</h1>
<h3>Location:</h3>
<p>Lat: <%= @saved_location.location.latitude %></p>
<p>Long: <%= @saved_location.location.longitude %></p>



<!--  Display API data   -->

<!--56f593e1971d4690b3b16b3523f9c7b4 -->

<!-- Add logic to check whether user already has the save dlocation -->
<% if !logged_in? %>
  <a href="/login/index">Log in to save this location</a>
<% else %>
  <form method="post" action="/locations">
    <input id="" type="hidden" value="">
    <input id="" type="hidden" value="">

    <input type="submit" value="Save Location!">
  </form>
<% end %>


<div class="display-data">

  <div class="todays-data">
    <h3>Today's Air Quality Index:</h3>
    <p><%= @aq_data["aqi_description"] %></p>
    <p>Dominant pollutant: <%= @aq_data["dom_poll"] %></p>
  </div>

  <div class="historical-data">
    <h3>Historical Air Quality Information:</h3>
  </div>

</div>

<script>

  var dataset = <%= @aq_data_json %>
  var aqi_data = [dataset["aqi"]]
  var aqi_color = [dataset["aqi_color"]]


  //Width and height
  var w = 20;
  var h = 100;
  var barPadding = 1;

  //Data

  //Create SVG element
  var svg = d3.select(".todays-data")
        .append("svg")
        .attr("width", w)
        .attr("height", h)
        .attr("margin-left", "50px");

  svg.selectAll("rect")
     .data(aqi_data)
     .enter()
     .append("rect")
     .attr("x", function(d, i) {
        return i * (w / aqi_data.length);
     })
     .attr("y", function(d) {
        return h - (d);
     })
     .attr("width", w / aqi_data.length - barPadding)
     .attr("height", function(d) {
        return d;
     })
     .attr("fill", aqi_color);

  svg.selectAll("text")
     .data(aqi_data)
     .enter()
     .append("text")
     .text(function(d) {
        return d;
     })
     .attr("text-anchor", "middle")
     .attr("x", function(d, i) {
        return i * (w / aqi_data.length) + (w / aqi_data.length - barPadding) / 2;
     })
     .attr("y", function(d) {
        return h - (d) + 14;
     })
     .attr("font-family", "sans-serif")
     .attr("font-size", "11px")
     .attr("fill", "white");

</script>




















